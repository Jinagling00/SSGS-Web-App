<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼‘ã€é€€å­¸èˆ‡å¾©å­¸æŒ‡å¼•</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/SSGS-Web-App/styles.css">
    <style>
        .step-section { display: none; }
        .step-section.active { display: block; }
        .id-display-badge { background: var(--primary-color); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9em; margin-bottom: 20px; display: inline-block; }
        .warning-note { background-color: #ffeaea; border-left: 5px solid red; padding: 15px; margin-top: 15px; color: #cc0000; text-align: left; }
        .step-list { text-align: left; list-style: disc; padding-left: 20px; }
        .location-hint { color: #2e7d32; font-weight: bold; }
        .download-link { color: var(--primary-color); font-weight: bold; text-decoration: underline; }
        .error-hint { color: red; font-size: 0.85em; display: none; margin-top: -15px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <div id="step-identify" class="step-section active">
            <h1>ğŸ†” èº«ä»½è¾¨è­˜</h1>
            <p>è«‹è¼¸å…¥å­¸è™Ÿä»¥å–å¾—ç²¾æº–çš„ä¼‘/é€€/å¾©å­¸ç”³è«‹æµç¨‹ï¼š</p>
            <input type="text" id="studentIdInput" placeholder="è«‹è¼¸å…¥ 10 ç¢¼å­¸è™Ÿ" maxlength="10" class="calc-input" 
                   style="width: 80%; max-width: 300px; margin-bottom: 20px; padding: 10px; border: 2px solid var(--primary-color); border-radius: 8px;">
            <div id="idError" class="error-hint">âš ï¸ è«‹è¼¸å…¥æ­£ç¢ºçš„ 10 ç¢¼æ•¸å­—å­¸è™Ÿ</div>
            <br>
            <button onclick="startGuide()" class="decision-button">å–å¾—ç²¾æº–æµç¨‹</button>
            <p style="font-size: 0.8em; color: #666; margin-top: 15px;">â€» æœ¬ç³»çµ±åƒ…æ–¼ç€è¦½å™¨è¨˜æ†¶é«”è™•ç†è³‡è¨Šï¼Œé—œé–‰å¾Œå³å¾¹åº•æ¸…é™¤ã€‚</p>
        </div>

        <div id="step-content" class="step-section">
            <div class="id-display-badge">ç•¶å‰å­¸è™Ÿï¼š<span id="currentIdDisplay"></span></div>
            <h1>â³ ä¼‘/é€€å­¸èˆ‡å¾©å­¸æŒ‡å¼•</h1>
            <p>æ‚¨çš„èº«ä»½å·²è¾¨è­˜ç‚ºï¼š<strong id="studentLevelDisplay" style="color: var(--primary-color);"></strong>ã€‚</p>
            
            <div id="dynamicGuideBody"></div>

            <div style="margin-top: 30px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button onclick="resetSPA()" class="option-button" style="background-color: #f0f0f0; color: #333; width: auto; padding: 10px 20px;">é‡æ–°æŸ¥è©¢</button>
                <a href="/SSGS-Web-App/service_menu.html" class="option-button" style="width: auto; padding: 10px 20px;">è¿”å›æœå‹™é¸å–®</a>
            </div>
        </div>
    </div>

    <script>
        function startGuide() {
            const idInput = document.getElementById('studentIdInput');
            const errorHint = document.getElementById('idError');
            const id = idInput.value.trim();
            
            // åŠ å…¥ 10 ç¢¼æ•¸å­—é™åˆ¶çš„æ­£è¦è¡¨é”å¼é©—è­‰
            const idRegex = /^[0-9]{10}$/;
            
            if (!idRegex.test(id)) {
                errorHint.style.display = 'block';
                idInput.style.borderColor = 'red';
                return;
            } else {
                errorHint.style.display = 'none';
                idInput.style.borderColor = 'var(--primary-color)';
            }

            let studentLevel = "ä¸€èˆ¬ç”Ÿ";
            let requiresConsent = false;
            let isMinsheng = false;

            // è¾¨è­˜é‚è¼¯ï¼šæª¢æŸ¥ç¬¬äºŒç¢¼æ˜¯å¦ç‚º 1, 2, 4
            const secondChar = id.charAt(1);
            if (['1', '2', '4'].includes(secondChar)) {
                requiresConsent = true;
                studentLevel = (secondChar === '1') ? "äº”å°ˆéƒ¨" : "å››æŠ€/äºŒæŠ€éƒ¨";
            } else {
                requiresConsent = false;
                studentLevel = "ç ”ç©¶æ‰€/é€²ä¿®éƒ¨/å…¶ä»–å­¸åˆ¶";
            }

            // åˆ¤æ–·æ ¡å€ (è­·ç†ã€ç¾å®¹ã€è€æœç³»)
            if (id.includes("510") || id.includes("520") || id.includes("530")) {
                isMinsheng = true;
            }

            document.getElementById('currentIdDisplay').textContent = id;
            document.getElementById('studentLevelDisplay').textContent = studentLevel;

            let contentHtml = '<div class="result-box" style="text-align:left;">';
            contentHtml += '<h3>ç¬¬ä¸€éšæ®µï¼šç”³è«‹æ–‡ä»¶æº–å‚™</h3>';
            contentHtml += `<p>è¾¦ç†åœ°é»ï¼š<span class="location-hint">ä¸‰æ°‘æ ¡å€ï¼ˆä¸­æ­£å¤§æ¨“2æ¨“ï¼‰</span> æˆ– <span class="location-hint">æ°‘ç”Ÿæ ¡å€ï¼ˆèª æ•¬æ¨“2æ¨“ï¼‰</span>ã€‚</p>`;
            
            if (isMinsheng) {
                contentHtml += '<p style="color:red; font-weight:bold;">âš ï¸ æé†’ï¼šæ‚¨çš„ç§‘ç³»è«‹è‡³æ°‘ç”Ÿæ ¡å€è¾¦ç†ã€‚</p>';
            }

            contentHtml += '<h4>ä¼‘ã€é€€å­¸å¿…å‚™æ–‡ä»¶æ¸…å–®</h4>';
            contentHtml += '<ul class="step-list">';
            contentHtml += `<li><a href="/SSGS-Web-App/forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸(ä¼‘ã€é€€ã€å¾©)å­¸ç”³è«‹æ›¸.pdf" download class="download-link">ã€Š(ä¼‘ã€é€€ã€å¾©)å­¸ç”³è«‹æ›¸ã€‹</a> (B4å°ºå¯¸)</li>`;
            
            if (requiresConsent) {
                contentHtml += `
                    <li class="warning-note">
                        <strong>å¿…å‚™æ–‡ä»¶ï¼š</strong> <a href="/SSGS-Web-App/forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸(ä¼‘ã€é€€)å­¸å®¶é•·åŒæ„æ›¸.pdf" download style="color:red; font-weight:bold;">ã€Šå®¶é•·åŒæ„æ›¸ã€‹</a><br>
                        (å› æ‚¨çš„å­¸åˆ¶è¾¨è­˜ç‚º ${studentLevel}ï¼Œéœ€æª¢é™„å®¶é•·æˆ–ç›£è­·äººç°½ç« )
                    </li>`;
            } else {
                contentHtml += '<li><strong style="color: green;">ç„¡éœ€</strong> ç¹³äº¤å®¶é•·åŒæ„æ›¸ (ç ”ç©¶æ‰€/é€²ä¿®éƒ¨)ã€‚</li>';
            }

            contentHtml += '<li>å­¸ç”Ÿè­‰ (å¦‚éºå¤±é ˆå…ˆç·šä¸Šæ›å¤±ä¸¦æ–¼ç”³è«‹æ›¸è¨»æ˜)</li>';
            contentHtml += '<li>å­¸é›œè²»é€€è²»ï¼šç¬¦åˆé€€è²»æ¨™æº–è€…ï¼Œè«‹é™„ç¹³è²»æ”¶æ“šæ­£æœ¬åŠæœ¬äººå­˜æ‘ºå°é¢å½±æœ¬ã€‚</li>';
            contentHtml += '</ul>';

            contentHtml += '<h4 style="margin-top: 20px;">ç¬¬äºŒéšæ®µï¼šæœƒè¾¦èˆ‡ç‰¹æ®Šè™•ç†</h4>';
            contentHtml += '<ul class="step-list">';
            contentHtml += '<li><strong>æµç¨‹é †åºï¼š</strong> å°å¸« â†’ ç³»ä¸»ä»» â†’ ç›¸é—œæœƒè¾¦å–®ä½ â†’ è¨»å†Šçµ„ã€‚</li>';
            contentHtml += '<li><strong>å­¸è²¸èº«ä»½ï¼š</strong> éœ€æœƒè¾¦èª²å¤–æ´»å‹•æŒ‡å°çµ„ã€‚</li>';
            contentHtml += '<li><strong>å…µå½¹æé†’ï¼š</strong> ç”·ç”Ÿæœªæœå½¹éœ€è‡³è¨»å†Šçµ„å¡«å¯«å…µå½¹åˆ‡çµæ›¸ã€‚</li>';
            contentHtml += '</ul>';
            contentHtml += '</div>';

            document.getElementById('dynamicGuideBody').innerHTML = contentHtml;
            document.getElementById('step-identify').classList.remove('active');
            document.getElementById('step-content').classList.add('active');
        }

        function resetSPA() {
            document.getElementById('studentIdInput').value = "";
            document.getElementById('idError').style.display = 'none';
            document.getElementById('studentIdInput').style.borderColor = 'var(--primary-color)';
            document.getElementById('step-content').classList.remove('active');
            document.getElementById('step-identify').classList.add('active');
        }
    </script>
</body>
</html>
