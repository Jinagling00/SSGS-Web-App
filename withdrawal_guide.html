<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼‘ã€é€€å­¸èˆ‡å¾©å­¸æŒ‡å¼• - SSGS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/SSGS-Web-App/styles.css">
    <style>
        .step-section { display: none; }
        .step-section.active { display: block; }
        .id-display-badge { background: var(--primary-color); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9em; margin-bottom: 20px; display: inline-block; }
        .warning-note { background-color: #ffeaea; border-left: 5px solid red; padding: 15px; margin-top: 15px; color: #cc0000; text-align: left; }
        .step-list { text-align: left; list-style: disc; padding-left: 20px; }
        .location-hint { color: #2e7d32; font-weight: bold; }
        .download-link { color: var(--primary-color); font-weight: bold; text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <div id="step-identify" class="step-section active">
            <h1>ğŸ†” èº«ä»½è¾¨è­˜</h1>
            <p>è«‹è¼¸å…¥å­¸è™Ÿä»¥å–å¾—ç²¾æº–çš„ä¼‘/é€€/å¾©å­¸ç”³è«‹æµç¨‹ï¼š</p>
            <input type="text" id="studentIdInput" placeholder="è«‹è¼¸å…¥å­¸è™Ÿ (å¦‚: 112210123)" class="calc-input" 
                   style="width: 80%; max-width: 300px; margin-bottom: 20px; padding: 10px; border: 2px solid var(--primary-color); border-radius: 8px;">
            <br>
            <button onclick="startGuide()" class="decision-button">å–å¾—ç²¾æº–æµç¨‹</button>
            <p style="font-size: 0.8em; color: #666; margin-top: 15px;">â€» æœ¬ç³»çµ±ä¸æœƒå„²å­˜æ‚¨çš„å­¸è™Ÿï¼Œé—œé–‰ç¶²é å¾Œè³‡è¨Šå³æ¸…é™¤ã€‚</p>
        </div>

        <div id="step-content" class="step-section">
            <div class="id-display-badge">ç•¶å‰å­¸è™Ÿï¼š<span id="currentIdDisplay"></span></div>
            <h1>â³ ä¼‘/é€€å­¸èˆ‡å¾©å­¸æŒ‡å¼•</h1>
            <p>æ‚¨çš„èº«ä»½å·²è¾¨è­˜ç‚ºï¼š<strong id="studentLevelDisplay" style="color: var(--primary-color);"></strong>ã€‚</p>
            
            <div id="dynamicGuideBody">
                </div>

            <div style="margin-top: 30px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button onclick="resetSPA()" class="option-button" style="background-color: #f0f0f0; color: #333; width: auto; padding: 10px 20px;">é‡æ–°æŸ¥è©¢</button>
                <a href="/SSGS-Web-App/service_menu.html" class="option-button" style="width: auto; padding: 10px 20px;">è¿”å›æœå‹™é¸å–®</a>
            </div>
        </div>
    </div>

    <script>
        function startGuide() {
            const idInput = document.getElementById('studentIdInput');
            const id = idInput.value.trim();
            if (!id) { alert("è«‹è¼¸å…¥å­¸è™Ÿï¼"); return; }

            // 1. åŸ·è¡Œè¾¨è­˜é‚è¼¯
            let studentLevel = "ä¸€èˆ¬ç”Ÿ";
            let requiresConsent = false;
            let isMinsheng = false;

            if (id.length === 9) {
                const secondChar = id.charAt(1);
                if (['1', '2', '3', '4', 'A'].includes(secondChar)) {
                    studentLevel = "äº”å°ˆéƒ¨";
                    requiresConsent = true;
                } else if (['6', 'B'].includes(secondChar)) {
                    studentLevel = "å››æŠ€/å¤§å­¸éƒ¨";
                    requiresConsent = true;
                } else if (secondChar === '5') {
                    studentLevel = "äºŒæŠ€éƒ¨";
                    requiresConsent = true;
                } else if (['7', '8', '9'].includes(secondChar)) {
                    studentLevel = "ç ”ç©¶æ‰€";
                    requiresConsent = false;
                }
            } else if (id.length === 8) {
                studentLevel = "é€²ä¿®éƒ¨/å…¶ä»–";
                requiresConsent = false;
            }

            // åˆ¤æ–·æ ¡å€ (è­·ç†ã€ç¾å®¹ã€è€æœç³»ï¼š510, 520, 530)
            if (id.includes("510") || id.includes("520") || id.includes("530")) {
                isMinsheng = true;
            }

            // 2. æ›´æ–°é¡¯ç¤ºè³‡è¨Š
            document.getElementById('currentIdDisplay').textContent = id;
            document.getElementById('studentLevelDisplay').textContent = studentLevel;

            // 3. æ§‹å»º HTML å…§å®¹
            let contentHtml = '<div class="result-box" style="text-align:left;">';
            contentHtml += '<h3>ç¬¬ä¸€éšæ®µï¼šç”³è«‹æ–‡ä»¶æº–å‚™</h3>';
            contentHtml += `<p>è¾¦ç†åœ°é»ï¼š<span class="location-hint">ä¸‰æ°‘æ ¡å€ï¼ˆä¸­æ­£å¤§æ¨“2æ¨“ï¼‰</span> æˆ– <span class="location-hint">æ°‘ç”Ÿæ ¡å€ï¼ˆèª æ•¬æ¨“2æ¨“ï¼‰</span>ã€‚</p>`;
            
            if (isMinsheng) {
                contentHtml += '<p style="color:red; font-weight:bold;">âš ï¸ æé†’ï¼šæ‚¨çš„ç§‘ç³»è«‹è‡³æ°‘ç”Ÿæ ¡å€è¾¦ç†ã€‚</p>';
            }

            contentHtml += '<h4>ä¼‘ã€é€€å­¸å¿…å‚™æ–‡ä»¶æ¸…å–®</h4>';
            contentHtml += '<ul class="step-list">';
            contentHtml += `<li><a href="/SSGS-Web-App/forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸(ä¼‘ã€é€€ã€å¾©)å­¸ç”³è«‹æ›¸.pdf" download class="download-link">ã€Š(ä¼‘ã€é€€ã€å¾©)å­¸ç”³è«‹æ›¸ã€‹</a> (B4å°ºå¯¸)</li>`;
            
            if (requiresConsent) {
                contentHtml += `
                    <li class="warning-note">
                        <strong>å¿…å‚™æ–‡ä»¶ï¼š</strong> <a href="/SSGS-Web-App/forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸(ä¼‘ã€é€€)å­¸å®¶é•·åŒæ„æ›¸.pdf" download style="color:red; font-weight:bold;">ã€Šå®¶é•·åŒæ„æ›¸ã€‹</a><br>
                        (å› æ‚¨å±¬æ–¼ ${studentLevel}ï¼Œéœ€æª¢é™„å®¶é•·æˆ–ç›£è­·äººç°½ç« )
                    </li>`;
            } else {
                contentHtml += '<li><strong style="color: green;">ç„¡éœ€</strong> ç¹³äº¤å®¶é•·åŒæ„æ›¸ã€‚</li>';
            }

            contentHtml += '<li>å­¸ç”Ÿè­‰ (å¦‚éºå¤±é ˆå…ˆç·šä¸Šæ›å¤±ï¼Œä¸¦æ–¼ç”³è«‹æ›¸è¨»æ˜)</li>';
            contentHtml += '<li>å­¸é›œè²»é€€è²»ï¼šç¬¦åˆé€€è²»æ¨™æº–è€…ï¼Œè«‹é™„ç¹³è²»æ”¶æ“šæ­£æœ¬åŠæœ¬äººå­˜æ‘ºå°é¢å½±æœ¬ã€‚</li>';
            contentHtml += '</ul>';

            contentHtml += '<h4 style="margin-top: 20px;">ç¬¬äºŒéšæ®µï¼šæœƒè¾¦èˆ‡ç‰¹æ®Šè™•ç†</h4>';
            contentHtml += '<ul class="step-list">';
            contentHtml += '<li><strong>æµç¨‹é †åºï¼š</strong> å°å¸« â†’ ç³»æ‰¿è¾¦+ç³»ä¸»ä»» â†’ ç›¸é—œæœƒè¾¦å–®ä½ â†’ è¨»å†Šçµ„ã€‚</li>';
            contentHtml += '<li><strong>å­¸è²¸èº«ä»½ï¼š</strong> éœ€æœƒè¾¦èª²å¤–æ´»å‹•æŒ‡å°çµ„ã€‚</li>';
            contentHtml += '<li><strong>å…µå½¹æé†’ï¼š</strong> ç”·ç”Ÿæœªæœå½¹éœ€å…ˆè‡³è¨»å†Šçµ„å¡«å¯«å…µå½¹åˆ‡çµæ›¸ï¼Œä¸¦æœƒè¾¦å­¸å‹™è™•å…µå½¹æ‰¿è¾¦ã€‚</li>';
            contentHtml += '<li><strong>ä½å®¿ç”Ÿï¼š</strong> æœ‰ä½å­¸ç”Ÿå®¿èˆéœ€è‡³å®¿èˆçµ„æœƒè¾¦ (åŒ…å«æ°‘ç”Ÿæ ¡å€å­¸ç”Ÿ)ã€‚</li>';
            contentHtml += '</ul>';

            contentHtml += '<h4 style="margin-top: 20px;">ğŸ“Œ å¾©å­¸æç¤º</h4>';
            contentHtml += '<p>ä¼‘å­¸æœŸæ»¿è€…ï¼Œè«‹è‡³è¨»å†Šçµ„è©¢å•å¾©å­¸æµç¨‹ã€‚</p>';
            contentHtml += '</div>';

            // åŸ·è¡Œæ’å…¥
            document.getElementById('dynamicGuideBody').innerHTML = contentHtml;

            // 4. åˆ‡æ›å€å¡Š
            document.getElementById('step-identify').classList.remove('active');
            document.getElementById('step-content').classList.add('active');
        }

        function resetSPA() {
            document.getElementById('studentIdInput').value = "";
            document.getElementById('step-content').classList.remove('active');
            document.getElementById('step-identify').classList.add('active');
        }
    </script>
</body>
</html>
