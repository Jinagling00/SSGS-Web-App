<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡ä»¶ç”³è«‹æŸ¥è©¢</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css"> 
    <style>
        .search-container { margin: 20px 0; position: relative; }
        #docSearch { width: 100%; padding: 12px 20px; border: 2px solid var(--primary-color); border-radius: 25px; font-size: 1em; outline: none; box-sizing: border-box; }
        .checklist-box { background: #f0f4f8; padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #d1d9e0; }
        .checklist-item { display: flex; align-items: center; margin-bottom: 8px; cursor: pointer; text-align: left; }
        .checklist-item input { margin-right: 10px; width: 18px; height: 18px; cursor: pointer; }
        .location-box { background-color: #e8f5e9; border: 1px solid #2e7d32; padding: 12px; border-radius: 8px; margin-top: 10px; text-align: left; }
        .location-title { color: #2e7d32; font-weight: bold; margin-bottom: 5px; display: block; }
        .machine-red { color: #d32f2f; font-weight: bold; }
        .machine-yellow { color: #fbc02d; font-weight: bold; text-shadow: 0.5px 0.5px 1px #000; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.6); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 30px; border: 1px solid #888; width: 90%; max-width: 650px; border-radius: 10px; position: relative; }
        .close-btn { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .step-list { list-style: none; padding: 0; text-align: left; }
        .step-list li { background: #f7f7f7; padding: 10px; border-left: 4px solid var(--primary-color); margin-bottom: 8px; font-size: 0.95em; }
    </style>
</head>
<body>
    <script src="app.js"></script>

    <div class="container"> 
        <h1>ğŸ“„ æµç¨‹ Aï¼šç”³è«‹æ–‡ä»¶æŸ¥è©¢</h1>
        
        <div class="search-container">
            <input type="text" id="docSearch" placeholder="ğŸ” è¼¸å…¥é—œéµå­—æœå°‹ (ä¾‹å¦‚ï¼šæˆç¸¾ã€è­·ç…§ã€è‹±æ–‡)..." onkeyup="filterDocuments()">
        </div>
        <p>ç”³è«‹æ–‡ä»¶è«‹å¡«å¯«å„é …è­‰æ˜ç”³è«‹æ›¸ã€‚</p>
        <p>å§”è¨—ä»–äººè¾¦ç†è€…è«‹å¡«å¯«å§”è¨—æ›¸ï¼Œä¸¦è²¼ä¸Šèº«åˆ†è­‰æ­£åé¢å½±æœ¬ï¼Œå—è¨—äººæ”œå¸¶è‡ªå·±èº«åˆ†è­‰æ­£æœ¬ä¾›æ ¸å°èº«åˆ†ã€‚</p>
        
        <div style="margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
            <a href="forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸æ—¥é–“éƒ¨è¨»å†Šçµ„å„é …è­‰æ˜ç”³è«‹æ›¸.pdf" download class="option-button" style="background-color: #e0f2ff; color: #00478F; border: 1px solid #00478F; display: inline-block; width: auto; padding: 10px 20px;" onclick="trackClick('btn_download', 'ä¸‹è¼‰ç”³è«‹æ›¸')">ğŸ“¥ ä¸‹è¼‰ã€Šå„é …è­‰æ˜ç”³è«‹æ›¸ã€‹</a>
            <a href="forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸å§”è¨—æ›¸.pdf" download class="option-button" style="background-color: #e0f2ff; color: #00478F; border: 1px solid #00478F; display: inline-block; width: auto; padding: 10px 20px;" onclick="trackClick('btn_download', 'ä¸‹è¼‰å§”è¨—æ›¸')">ğŸ“¥ ä¸‹è¼‰ã€Šå§”è¨—æ›¸ã€‹</a>
        </div>

        <div id="doc-container">
            <h2 class="document-group-title">ä¸­æ–‡æ–‡ä»¶ç”³è«‹</h2>
            <div class="document-grid">
                <div class="document-card" data-title="ä¸­æ–‡æ­·å¹´æˆç¸¾å–®" onclick="showDocumentDetail('chinese_transcript')"><h3>ä¸­æ–‡æ­·å¹´æˆç¸¾å–®</h3></div>
                <div class="document-card" data-title="ä¸­æ–‡åœ¨å­¸è­‰æ˜æ›¸" onclick="showDocumentDetail('in_school')"><h3>ä¸­æ–‡åœ¨å­¸è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="å­¸ä½ç•¢æ¥­è­‰æ›¸å½±æœ¬" onclick="showDocumentDetail('degree_copy')"><h3>å­¸ä½(ç•¢æ¥­)è­‰æ›¸å½±æœ¬</h3></div>
                <div class="document-card" data-title="ä¸­æ–‡ä¼‘å­¸è­‰æ˜æ›¸" onclick="showDocumentDetail('chinese_suspension_cert')"><h3>ä¸­æ–‡ä¼‘å­¸è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="ä¸­æ–‡ä¿®æ¥­è­‰æ˜æ›¸" onclick="showDocumentDetail('chinese_completion_cert')"><h3>ä¸­æ–‡ä¿®æ¥­è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="è£œç™¼ä¸­æ–‡å­¸ä½è­‰æ˜æ›¸" onclick="showDocumentDetail('chinese_degree_cert')"><h3>è£œç™¼ä¸­æ–‡å­¸ä½è­‰æ˜æ›¸</h3></div>
            </div>

            <h2 class="document-group-title">è‹±æ–‡æ–‡ä»¶ç”³è«‹</h2>
            <div class="document-grid">
                <div class="document-card" data-title="è‹±æ–‡æ­·å¹´æˆç¸¾å–®" onclick="showDocumentDetail('english_transcript')"><h3>è‹±æ–‡æ­·å¹´æˆç¸¾å–®</h3></div>
                <div class="document-card" data-title="è‹±æ–‡åœ¨å­¸è­‰æ˜æ›¸" onclick="showDocumentDetail('english_in_school')"><h3>è‹±æ–‡åœ¨å­¸è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="è‹±æ–‡ä¼‘å­¸è­‰æ˜æ›¸" onclick="showDocumentDetail('english_suspension_cert')"><h3>è‹±æ–‡ä¼‘å­¸è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="è‹±æ–‡ä¿®æ¥­è­‰æ˜æ›¸" onclick="showDocumentDetail('english_completion_cert')"><h3>è‹±æ–‡ä¿®æ¥­è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="è‹±æ–‡å­¸ä½è­‰æ˜æ›¸" onclick="showDocumentDetail('english_degree_cert')"><h3>è‹±æ–‡å­¸ä½è­‰æ˜æ›¸</h3></div>
                <div class="document-card" data-title="è‹±æ–‡ç•¢æ¥­è­‰æ˜æ›¸" onclick="showDocumentDetail('english_grad_cert')"><h3>è‹±æ–‡ç•¢æ¥­è­‰æ˜æ›¸(92å¹´å‰)</h3></div>
            </div>
        </div>

        <h2 class="document-group-title">âš–ï¸ éƒµå¯„è²»ç”¨ç²¾ç®—å·¥å…·</h2>
        <div class="result-box" style="border: 2px solid var(--primary-color); background-color: #fff; padding: 25px; margin-top: 10px;">
            <div id="calculator-form" style="text-align: left; font-size: 0.95em;">
                <div class="calc-row"><label>ä¸­æ–‡æˆç¸¾å–®ã€ä¸­/è‹±æ–‡åœ¨å­¸è­‰æ˜ã€ä¼‘å­¸è­‰æ˜ã€å­¸ä½è­‰æ˜æ›¸å½±æœ¬ ($10, 5g):</label><input type="number" class="calc-input" data-price="10" data-weight="5" min="0" value="0"></div>
                <div class="calc-row"><label>ä¸­/è‹±æ–‡ä¿®æ¥­è­‰æ˜æ›¸ ($10, 15g):</label><input type="number" class="calc-input" data-price="10" data-weight="15" min="0" value="0"></div>
                <div class="calc-row"><label>è‹±æ–‡å­¸ä½è­‰æ˜æ›¸ ($100, 15g):</label><input type="number" class="calc-input" data-price="100" data-weight="15" min="0" value="0"></div>
                <div class="calc-row"><label>è‹±æ–‡æˆç¸¾å–® ($10, 25g):</label><input type="number" class="calc-input" data-price="10" data-weight="25" min="0" value="0"></div>
                
                <div style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
                    <div class="calc-row"><label>å›éƒµä¿¡å°:</label><select id="envelope-type" style="padding: 5px;"><option value="20">å¤§ä¿¡å°(20g)</option><option value="8">å°ä¿¡å°(8g)</option></select></div>
                    <div class="calc-row"><label>éœ€è¦å½Œå° (10g/å€‹):</label><input type="number" id="seal-count" min="0" value="0" class="calc-input-extra"></div>
                    <div class="calc-row"><label>éƒµå¯„æ–¹å¼:</label><select id="mail-method" style="padding: 5px;"><option value="registered">æ›è™Ÿ</option><option value="express-reg">é™æ™‚æ›è™Ÿ (+7å…ƒ)</option></select></div>
                </div>

                <div class="fee-display-container" style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 120px; background: #fffde7; padding: 15px; border-radius: 8px; text-align: center;">ğŸ’° åŒ¯ç¥¨é‡‘é¡ï¼š<span id="money-order-total">0</span> å…ƒ</div>
                    <div style="flex: 1; min-width: 120px; background: #e0f2ff; padding: 15px; border-radius: 8px; text-align: center;">âœ‰ï¸ éƒµè³‡ï¼š<span id="stamp-total">0</span> å…ƒ</div>
                    <div style="flex: 1; min-width: 120px; background: #f1f8e9; padding: 15px; border-radius: 8px; text-align: center;">âš–ï¸ ç¸½é‡é‡ï¼š<span id="weight">0</span> g</div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button onclick="handleCalcAndSync()" class="decision-button" style="width: 100%; background-color: #00478F;">
                        âœ… ç¢ºèªè¨ˆç®—çµæœ
                    </button>
                </div>
                
                <button onclick="calculatePreciseFees(); trackClick('btn_calc', 'åŸ·è¡Œç²¾ç®—å·¥å…·')" class="decision-button" style="margin-top:20px; width:100%;">é‡æ–°è¨ˆç®—è³‡è²»</button>
            </div>
        </div>
        
        <a href="service_menu.html" class="option-button back-to-home-btn">&larr; è¿”å›æœå‹™é¸å–®</a>
    </div>

    <div id="documentModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle" style="color: var(--primary-color); margin-top: 0;"></h2>
            <div id="modalBody"></div>
            <div class="checklist-box">
                <span class="location-title">âœ… ç”³è«‹å‰å¿…å‚™æ¸…å–® (è«‹å‹¾é¸ç¢ºèª)</span>
                <div id="checklistContent"></div>
            </div>
            <div id="machineLocationBox" class="location-box" style="display:none;">
                <span class="location-title">ğŸ“ è‡ªå‹•ç¹³è²»æ©Ÿä½ç½®æŒ‡å—ï¼š</span>
                <ul style="margin: 0; padding-left: 20px; font-size: 0.9em;">
                    <li><span class="machine-red">ç´…è‰²ç¹³è²»æ©Ÿï¼š</span>ä¸­æ­£å¤§æ¨“ 2F æ—‹è½‰æ¨“æ¢¯å‰çš„è…³è¸è»Šæ—ã€‚</li>
                    <li><span class="machine-yellow">é»ƒè‰²ç¹³è²»æ©Ÿï¼š</span>è³‡è¨Šæ¨“ 1F äº‹å‹™çµ„å°é¢é›»æ¢¯æ—ã€‚</li>
                </ul>
            </div>
            <div class="mail-rule-box" style="margin-top:15px; border-top:1px solid #eee; padding-top:10px;">
                <h4>âœ‰ï¸ éƒµå¯„ç”³è«‹å…±é€šè¦å‰‡</h4>
                <ul style="padding-left: 20px; font-size: 0.95em;">
                    <li>åŒ¯ç¥¨æŠ¬é ­ï¼šåœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸ã€‚</li>
                    <li>å¿…å‚™é™„ä»¶ï¼šèº«åˆ†è­‰æ­£åé¢å½±å°æœ¬ã€‚</li>
                    <li><strong style="color: red;">ç‰¹æ®Šé™åˆ¶ï¼š</strong> <span id="mailRestriction"></span></li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // è³‡æ–™åº«å®šç¾©
        const documentData = {
            chinese_transcript: { title: "ä¸­æ–‡æ­·å¹´æˆç¸¾å–®ç”³è«‹", isMachine: true, items: ["å·¥æœ¬è²» (10å…ƒ/ä»½)", "æ¨ç”„ç”¨ã€ä¼‘é€€å­¸æˆç¸¾å–®éœ€ç¹³è²»æ”¶æ“š"], restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚åœ¨æ ¡ç”Ÿæ’åéœ€æ–¼ç¹³è²»æ©Ÿé¸æ“‡ã€Œæ¨ç”„ç”¨ã€ã€‚", content: `<ul class="step-list"><li>å–ä»¶æ–¹å¼ï¼šåˆ©ç”¨æ©Ÿå°ç¹³è²»å¾Œç«‹åˆ»å–ä»¶ã€‚</li><li>æ¨ç”„ç”¨/ä¼‘é€€å­¸ï¼šæŒæ”¶æ“šè‡³è¨»å†Šçµ„é ˜å–ã€‚</li></ul>` },
            in_school: { title: "ä¸­æ–‡åœ¨å­¸è­‰æ˜æ›¸ç”³è«‹", isMachine: true, items: ["å·²å®Œæˆç¹³è²»ä¸¦éŠ·å¸³è¨˜éŒ„", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "ç„¡æ³•éƒµå¯„ï¼Œè«‹è‡³æ ¡å…§æ©Ÿå°è¾¦ç†ã€‚", content: `<ul class="step-list"><li>æ¢ä»¶ï¼šå­¸é›œè²»å·²éŠ·å¸³æ–¹å¯ç”³è«‹ã€‚</li><li>å–ä»¶æ–¹å¼ï¼šæ©Ÿå°ç«‹å³åˆ—å°ã€‚</li></ul>` },
            degree_copy: { title: "å­¸ä½ç•¢æ¥­è­‰æ›¸å½±æœ¬ç”³è«‹", isMachine: false, items: ["ç”³è«‹æ›¸", "å­¸ä½è­‰æ›¸æ­£æœ¬", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚", content: `<ul class="step-list"><li>å–ä»¶ï¼š11é»å‰ç”³è«‹å¯ç•¶å¤©å–ä»¶ã€‚</li></ul>` },
            chinese_suspension_cert: { title: "ä¸­æ–‡ä¼‘å­¸è­‰æ˜æ›¸", isMachine: false, items: ["é™ä¼‘å­¸ç”Ÿ", "ç”³è«‹æ›¸", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "ç„¡é™åˆ¶ã€‚", content: `<ul class="step-list"><li>å–ä»¶ï¼šå¯æŒæ”¶æ“šé ˜å–æˆ–éƒµå¯„ã€‚</li></ul>` },
            chinese_completion_cert: { title: "ä¸­æ–‡ä¿®æ¥­è­‰æ˜æ›¸", isMachine: false, items: ["é™é€€å­¸ç”Ÿ", "ç”³è«‹æ›¸", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "ç„¡é™åˆ¶ã€‚", content: `<ul class="step-list"><li>å«æ­·å¹´æˆç¸¾å–®ã€‚</li></ul>` },
            chinese_degree_cert: { title: "è£œç™¼ä¸­æ–‡å­¸ä½è­‰æ˜æ›¸", isMachine: false, items: ["ç”³è«‹æ›¸", "å·¥æœ¬è²» (100å…ƒ/ä»½)", "èº«åˆ†è­‰"], restriction: "ç„¡æ³•éƒµéé ˜å–ã€‚", content: `<ul class="step-list"><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>` },
            english_transcript: { title: "è‹±æ–‡æ­·å¹´æˆç¸¾å–®ç”³è«‹", isMachine: false, items: ["ç”³è«‹æ›¸", "è­·ç…§å½±æœ¬", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚", content: `<ul class="step-list"><li>æ™‚ç¨‹ï¼šç´„ 3-7 å€‹å·¥ä½œå¤©ã€‚</li></ul>` },
            english_in_school: { title: "è‹±æ–‡åœ¨å­¸è­‰æ˜æ›¸", isMachine: false, items: ["ç”³è«‹æ›¸", "è­·ç…§å½±æœ¬", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚", content: `<ul class="step-list"><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>` },
            english_suspension_cert: { title: "è‹±æ–‡ä¼‘å­¸è­‰æ˜æ›¸", isMachine: false, items: ["ç”³è«‹æ›¸", "è­·ç…§å½±æœ¬", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚", content: `<ul class="step-list"><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>` },
            english_completion_cert: { title: "è‹±æ–‡ä¿®æ¥­è­‰æ˜æ›¸", isMachine: false, items: ["ç”³è«‹æ›¸", "è­·ç…§å½±æœ¬", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚", content: `<ul class="step-list"><li>å«è‹±æ–‡æˆç¸¾å–®ã€‚</li></ul>` },
            english_degree_cert: { title: "è‹±æ–‡å­¸ä½è­‰æ˜æ›¸", isMachine: false, items: ["ç”³è«‹æ›¸", "è­·ç…§å½±æœ¬", "å·¥æœ¬è²» (100å…ƒ/ä»½)"], restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚", content: `<ul class="step-list"><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>` },
            english_grad_cert: { title: "è‹±æ–‡ç•¢æ¥­è­‰æ˜æ›¸(92å¹´å‰)", isMachine: false, items: ["ç”³è«‹æ›¸", "è­·ç…§å½±æœ¬", "å·¥æœ¬è²» (10å…ƒ/ä»½)"], restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚", content: `<ul class="step-list"><li>æ™‚ç¨‹ï¼šç´„ 3-7 å€‹å·¥ä½œå¤©ã€‚</li></ul>` }
        };

        function filterDocuments() {
            const searchTerm = document.getElementById('docSearch').value.toLowerCase();
            document.querySelectorAll('.document-card').forEach(card => {
                const title = card.getAttribute('data-title').toLowerCase();
                card.style.display = title.includes(searchTerm) ? "" : "none";
            });
        }

        function showDocumentDetail(key) {
            const data = documentData[key];
            if (!data) return;
            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('modalBody').innerHTML = data.content;
            document.getElementById('mailRestriction').textContent = data.restriction;
            document.getElementById('machineLocationBox').style.display = data.isMachine ? "block" : "none";
            let checklistHtml = '';
            data.items.forEach(item => {
                checklistHtml += `<label class="checklist-item"><input type="checkbox"> <span>${item}</span></label>`;
            });
            document.getElementById('checklistContent').innerHTML = checklistHtml;
            document.getElementById('documentModal').style.display = 'block';
            trackClick('btn_apply', `æŸ¥è©¢æ–‡ä»¶ï¼š${data.title}`);
        }

        function closeModal() { document.getElementById('documentModal').style.display = 'none'; }
        window.onclick = function(event) { if (event.target == document.getElementById('documentModal')) closeModal(); }

        // ğŸ’¡ ä¿®æ­£å¾Œçš„è¨ˆç®—æ©Ÿé‚è¼¯
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('.calc-input, .calc-input-extra, #envelope-type, #mail-method');
            inputs.forEach(el => el.addEventListener('input', calculatePreciseFees));
            calculatePreciseFees();
        });

        function calculatePreciseFees() {
            let price = 0, weight = 0;
    
            // 1. è¨ˆç®—é‡‘é¡èˆ‡é‡é‡
            document.querySelectorAll('.calc-input').forEach(i => {
                const count = Number(i.value) || 0;
                price += count * Number(i.dataset.price);
                weight += count * Number(i.dataset.weight);
            });

            // 2. åŠ å…¥ä¿¡å°èˆ‡å½Œå°é‡é‡
            const envElem = document.getElementById('envelope-type');
            const sealElem = document.getElementById('seal-count');
            weight += envElem ? Number(envElem.value) : 0;
            weight += sealElem ? (Number(sealElem.value) || 0) * 10 : 0;

            // 3. éƒµè³‡è¨ˆç®—é‚è¼¯
            let baseFee = 0;
            if (weight > 0) {
                if (weight <= 20) baseFee = 28;
                else if (weight <= 50) baseFee = 36;
                else if (weight <= 100) baseFee = 44;
                else if (weight <= 250) baseFee = 60;
                else if (weight <= 500) baseFee = 92;
                else if (weight <= 1000) baseFee = 132;
                else baseFee = 180;
            }
            const mailMethodElem = document.getElementById('mail-method');
            const isExpress = mailMethodElem ? mailMethodElem.value === 'express-reg' : false;
            const finalStamp = (baseFee > 0) ? baseFee + (isExpress ? 7 : 0) : 0;
            
            // 4. ã€é—œéµä¿®æ­£ã€‘å®‰å…¨åœ°æ›´æ–°ç•«é¢ï¼Œé˜²æ­¢ null å ±éŒ¯
            const updateText = (id, value) => {
                const elem = document.getElementById(id);
                if (elem) {
                    elem.textContent = isNaN(value) ? 0 : value;
                } else {
                    console.warn(`æ‰¾ä¸åˆ° ID ç‚º "${id}" çš„å…ƒç´ ï¼Œè«‹æª¢æŸ¥ HTMLï¼`);
                }
            };

            updateText('money-order-total', price);
            updateText('stamp-total', finalStamp);
            updateText('weight', weight); // 

        }

        function handleCalcAndSync() {
            // åŸ·è¡Œè¨ˆç®—æ›´æ–°ç•«é¢
            calculatePreciseFees();

            // å–å¾—æ›´æ–°å¾Œçš„æ•¸å€¼ä¾›å‚³é€ä½¿ç”¨
            const price = document.getElementById('money-order-total').textContent;
            const stamp = document.getElementById('stamp-total').textContent;
            const weightValue = document.getElementById('weight').textContent;
            const isExpress = document.getElementById('mail-method').value === 'express-reg';
            const mailNote = isExpress ? "é™æ™‚æ›è™Ÿ" : "æ™®é€šæ›è™Ÿ";

            // 5. åŸ·è¡Œæ•¸æ“šè¿½è¹¤åŒæ­¥åˆ°é›²ç«¯
            if (typeof trackClick === 'function') {
                const resultLog = `${mailNote} / ç¸½é¡:${price}å…ƒ / éƒµè³‡:${stamp}å…ƒ / é‡é‡:${weightValue}g`;
                trackClick('btn_calc', resultLog);
                alert("è¨ˆç®—çµæœå·²æ›´æ–°ä¸¦è¨˜éŒ„æˆåŠŸï¼");
            }
        }
        // Service Worker è¨»å†Š
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js');
            });
        }
    </script>
</body>
</html>
