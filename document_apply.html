<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡ä»¶ç”³è«‹æŸ¥è©¢</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/SSGS-Web-App/styles.css"> 
    <style>
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.6); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 30px; border: 1px solid #888; width: 90%; max-width: 700px; border-radius: 10px; position: relative; }
        .close-btn { color: #aaa; float: right; font-size: 28px; font-weight: bold; line-height: 1; cursor: pointer; }
        .close-btn:hover { color: #000; }
        .mail-rule-box { background-color: #fffde7; border: 2px solid var(--accent-color); padding: 15px; margin-top: 20px; border-radius: 8px; text-align: left; }
        .mail-rule-box h4 { color: #b7a000; margin-top: 0; border-bottom: 1px dashed #ccc; padding-bottom: 5px; }
        .step-list { list-style: none; padding: 0; text-align: left; }
        .step-list li { background: #f7f7f7; padding: 10px; border-left: 4px solid var(--primary-color); margin-bottom: 8px; font-size: 0.95em; }
        .document-group-title { margin-top: 40px; margin-bottom: 10px; border-left: 5px solid var(--accent-color); padding-left: 10px; text-align: left; color: var(--primary-color); }
        
        .calc-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .calc-input { width: 65px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; text-align: center; }
        @media (max-width: 600px) { .fee-display-container { flex-direction: column; gap: 10px; } }
    </style>
</head>
<body>
    <div class="container"> 
        <h1>ğŸ“„ æµç¨‹ Aï¼šç”³è«‹æ–‡ä»¶æŸ¥è©¢</h1>
        <p>æ‰€æœ‰æ–‡ä»¶ç”³è«‹è«‹ä½¿ç”¨ã€Šæ—¥é–“éƒ¨è¨»å†Šçµ„å„é …è­‰æ˜ç”³è«‹æ›¸ã€‹ã€‚è«‹é»æ“Šå¡ç‰‡æŸ¥çœ‹è©³ç´°æ­¥é©Ÿã€‚</p>
        
        <div style="margin-bottom: 20px;">
            <a href="/SSGS-Web-App/forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸æ—¥é–“éƒ¨è¨»å†Šçµ„å„é …è­‰æ˜ç”³è«‹æ›¸.pdf" download class="option-button" style="background-color: #e0f2ff; color: #00478F; border: 1px solid #00478F; display: inline-block; width: auto; padding: 10px 20px; margin-right: 10px;">ğŸ“¥ ä¸‹è¼‰ã€Šå„é …è­‰æ˜ç”³è«‹æ›¸ã€‹</a>
            <a href="/SSGS-Web-App/forms/åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸å§”è¨—æ›¸.pdf" download class="option-button" style="background-color: #e0f2ff; color: #00478F; border: 1px solid #00478F; display: inline-block; width: auto; padding: 10px 20px;">ğŸ“¥ ä¸‹è¼‰ã€Šå§”è¨—æ›¸ã€‹</a>
        </div>
        <p>å§”è¨—ä»–äººè¾¦ç†è«‹å¡«å¯«å§”è¨—æ›¸ï¼Œæµ®è²¼å§”è¨—äººä¹‹èº«åˆ†è­‰æ­£åé¢å½±æœ¬ï¼Œå—è¨—äººæ‡‰æ”œå¸¶èº«åˆ†è­‰æ­£æœ¬ä¾›æ ¸å°ã€‚</p>

        <h2 class="document-group-title">ä¸­æ–‡æ–‡ä»¶ç”³è«‹ (Chinese Documents)</h2>
        <div class="document-grid">
            <div class="document-card" onclick="showDocumentDetail('chinese_transcript')"><h3>ä¸­æ–‡æ­·å¹´æˆç¸¾å–®</h3></div>
            <div class="document-card" onclick="showDocumentDetail('in_school')"><h3>ä¸­æ–‡åœ¨å­¸è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('degree_copy')"><h3>å­¸ä½(ç•¢æ¥­)è­‰æ›¸å½±æœ¬</h3></div>
            <div class="document-card" onclick="showDocumentDetail('chinese_suspension_cert')"><h3>ä¸­æ–‡ä¼‘å­¸è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('chinese_completion_cert')"><h3>ä¸­æ–‡ä¿®æ¥­è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('chinese_degree_cert')"><h3>è£œç™¼ä¸­æ–‡å­¸ä½è­‰æ˜æ›¸</h3></div>
        </div>

        <h2 class="document-group-title">è‹±æ–‡æ–‡ä»¶ç”³è«‹ (English Documents)</h2>
        <div class="document-grid">
            <div class="document-card" onclick="showDocumentDetail('english_transcript')"><h3>è‹±æ–‡æ­·å¹´æˆç¸¾å–®</h3></div>
            <div class="document-card" onclick="showDocumentDetail('english_in_school')"><h3>è‹±æ–‡åœ¨å­¸è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('english_suspension_cert')"><h3>è‹±æ–‡ä¼‘å­¸è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('english_completion_cert')"><h3>è‹±æ–‡ä¿®æ¥­è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('english_degree_cert')"><h3>è‹±æ–‡å­¸ä½è­‰æ˜æ›¸</h3></div>
            <div class="document-card" onclick="showDocumentDetail('english_old_grad')"><h3>è‹±æ–‡ç•¢æ¥­è­‰æ˜æ›¸(92å¹´å‰)</h3></div>
        </div>

        <h2 class="document-group-title">âš–ï¸ éƒµå¯„è²»ç”¨ç²¾ç®—å·¥å…·</h2>
        <div class="result-box">
            <p style="font-size: 0.9em; color: #666; margin-bottom: 20px;">è«‹è¼¸å…¥æ¬²ç”³è«‹ä»½æ•¸ï¼Œç³»çµ±å°‡ä¾æ“šé‡é‡ç´šè·é ä¼°éƒµè³‡ã€‚</p>
            <div id="calculator-form">
                <div class="calc-row"><label>ä¸­æ–‡æˆç¸¾/åœ¨å­¸/ä¼‘å­¸/ä¿®æ¥­ ($10, 5g):</label><input type="number" class="calc-input" data-price="10" data-weight="5" min="0" value="0"></div>
                <div class="calc-row"><label>ä¸­/è‹±æ–‡å­¸ä½è­‰æ˜æ›¸ ($100, 15g):</label><input type="number" class="calc-input" data-price="100" data-weight="15" min="0" value="0"></div>
                <div class="calc-row"><label>è‹±æ–‡æ­·å¹´æˆç¸¾å–® ($10, 25g):</label><input type="number" class="calc-input" data-price="10" data-weight="25" min="0" value="0"></div>

                <div style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
                    <div class="calc-row"><label>å›éƒµä¿¡å°é¡å‹:</label><select id="envelope-type" style="padding: 5px;"><option value="20">å¤§ä¿¡å° (20g)</option><option value="8">å°ä¿¡å° (8g)</option></select></div>
                    <div class="calc-row"><label>éœ€è¦å½Œå° (10g/å€‹):</label><input type="number" id="seal-count" min="0" value="0" class="calc-input"></div>
                    <div class="calc-row"><label>éƒµå¯„æ–¹å¼:</label><select id="mail-method" style="padding: 5px;"><option value="registered">æ›è™Ÿ</option><option value="express-reg">é™æ™‚æ›è™Ÿ (+7å…ƒ)</option></select></div>
                </div>

                <div class="fee-display-container" style="display: flex; gap: 15px; margin-top: 20px;">
                    <div style="flex: 1; background: #fffde7; padding: 15px; border-radius: 8px; border: 1px solid var(--accent-color); text-align: center;">
                        <span style="font-size: 0.85em; font-weight: bold; color: #b7a000;">ğŸ’° åŒ¯ç¥¨é‡‘é¡ (å·¥æœ¬è²»)</span><br>
                        <span id="money-order-total" style="font-size: 1.6em; font-weight: bold;">0</span> å…ƒ
                    </div>
                    <div style="flex: 1; background: #e0f2ff; padding: 15px; border-radius: 8px; border: 1px solid var(--primary-color); text-align: center;">
                        <span style="font-size: 0.85em; font-weight: bold; color: var(--primary-color);">âœ‰ï¸ å›éƒµéƒµè³‡ (è²¼éƒµç¥¨)</span><br>
                        <span id="stamp-total" style="font-size: 1.6em; font-weight: bold;">0</span> å…ƒ
                    </div>
                </div>
                <p style="font-size: 0.85em; color: #666; margin-top: 15px; text-align: center;">é ä¼°ç¸½é‡ï¼š<span id="total-weight">0</span>gã€‚éƒµè³‡ä¾æ“šä¸­è¯éƒµæ”¿è³‡è²»è¡¨è¨ˆç®—ã€‚</p>
            </div>
        </div>
        
        <a href="/SSGS-Web-App/service_menu.html" class="option-button back-to-home-btn">&larr; è¿”å›æœå‹™é¸å–®</a>
    </div>

    <div id="documentModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle" style="color: var(--primary-color); margin-top: 0;"></h2>
            <div id="modalBody"></div>
            <div class="mail-rule-box">
                <h4>âœ‰ï¸ éƒµå¯„ç”³è«‹å…±é€šè¦å‰‡ (é©ç”¨æ­¤æ–‡ä»¶)</h4>
                <ul style="padding-left: 20px; font-size: 0.95em;">
                    <li>å¿…å‚™æ–‡ä»¶ï¼šç”³è«‹æ›¸ã€èº«åˆ†è­‰æ­£åé¢å½±å°æœ¬ã€‚</li>
                    <li>è²»ç”¨æ”¯ä»˜ï¼šè«‹ä½¿ç”¨éƒµæ”¿åŒ¯ç¥¨æ”¯ä»˜å·¥æœ¬è²» (æŠ¬é ­ï¼šåœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸)ã€‚</li>
                    <li>å›ä»¶ä¿¡å°ï¼šè«‹è‡ªé™„å·²è²¼è¶³éƒµè³‡çš„æ›è™Ÿå›éƒµä¿¡å° (å¯ä½¿ç”¨è¨ˆç®—æ©Ÿå·¥å…·é ä¼°)ã€‚</li>
                    <li><strong style="color: red;">ç‰¹æ®Šé™åˆ¶ï¼š</strong> <span id="mailRestriction"></span></li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const documentData = {
            chinese_transcript: {
                title: "ä¸­æ–‡æ­·å¹´æˆç¸¾å–®ç”³è«‹ (å«æ’å/ä¸å«æ’å)",
                restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚åœ¨æ ¡ç”Ÿæ’åéœ€è‡³ç¹³è²»æ©Ÿé¸æ“‡ã€Œæ¨ç”„ç”¨æˆç¸¾å–®ã€ï¼Œç­æ’ã€ç³»æ’éœ€åˆ†é–‹ç”³è«‹ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>å–ä»¶ï¼šç«‹åˆ»å–ä»¶ (ä¸‰æ°‘æ ¡å€è‡ªå‹•ç¹³è²»æ©Ÿ)ã€‚ä¼‘é€€å­¸ç”Ÿè«‹æŒæ”¶æ“šè‡³è¨»å†Šçµ„å–ä»¶ã€‚</li></ul>`
            },
            in_school: {
                title: "ä¸­æ–‡åœ¨å­¸è­‰æ˜æ›¸ç”³è«‹",
                restriction: "åƒ…ä¾›åœ¨å­¸ç”Ÿè¾¦ç†ï¼Œä¸¦ä»¥ç•¶å­¸æœŸåœ¨å­¸è­‰æ˜ç‚ºä¸»ã€‚",
                content: `<ul class="step-list"><li>æ¢ä»¶ï¼šé ˆå­¸é›œè²»å·²ç¹³äº¤ä¸”å·²éŠ·å¸³æ–¹å¯ç”³è«‹ã€‚é–‹å­¸å…©é€±å…§è«‹æŒæ”¶æ“šè‡³è¨»å†Šçµ„äººå·¥éŠ·å¸³ã€‚</li><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>å–ä»¶ï¼šè‡ªå‹•ç¹³è²»æ©Ÿç¹³è²»å¾Œç«‹å³å–ä»¶ã€‚</li></ul>`
            },
            degree_copy: {
                title: "å­¸ä½(ç•¢æ¥­)è­‰æ›¸å½±æœ¬ç”³è«‹ (ä¸­æ–‡ç‰ˆ)",
                restriction: "è‹¥åƒ…ç”³è«‹å½±æœ¬ï¼Œå¯éƒµå¯„ã€‚é ˆå¸¶æ­£æœ¬ç”±è¨»å†Šçµ„å½±å°é€æ–‡æ›¸çµ„ç”¨å°ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>å¿…å‚™ï¼šå­¸ä½(ç•¢æ¥­)è­‰æ›¸æ­£æœ¬ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 0.5 è‡³ 1 å€‹å·¥ä½œæ—¥ã€‚</li></ul>`
            },
            chinese_suspension_cert: {
                title: "ä¸­æ–‡ä¼‘å­¸è­‰æ˜æ›¸ç”³è«‹",
                restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚",
                content: `<ul class="step-list"><li>å°è±¡ï¼šä¼‘å­¸ç”Ÿã€‚</li><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>å–ä»¶ï¼šç´„åŠå¤©å–ä»¶ã€‚</li></ul>`
            },
            chinese_completion_cert: {
                title: "ä¸­æ–‡ä¿®æ¥­è­‰æ˜æ›¸ç”³è«‹ (å«æˆç¸¾å–®)",
                restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚åƒ…é€€å­¸ç”Ÿå¯ç”³è«‹ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>å‚™è¨»ï¼šå…§å®¹å¿…é ˆåŒ…å«æ­·å¹´æˆç¸¾å–®ã€‚</li><li>å–ä»¶ï¼šç´„åŠå¤©å–ä»¶ã€‚</li></ul>`
            },
            chinese_degree_cert: {
                title: "è£œç™¼ä¸­æ–‡å­¸ä½è­‰æ˜æ›¸ (é™æ­£æœ¬éºå¤±è€…)",
                restriction: "ç„¡æ³•éƒµéé ˜å–ï¼é™æ­£æœ¬éºå¤±è€…ç”³è«‹ï¼Œç”³è«‹å¾ŒåŸæ­£æœ¬å¤±æ•ˆã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$100/ä»½ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>`
            },
            english_transcript: {
                title: "è‹±æ–‡æ­·å¹´æˆç¸¾å–®ç”³è«‹ (å¯å½Œå°/ä¸å½Œå°)",
                restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚é ˆé™„è­·ç…§å½±æœ¬ç¢ºèªå§“åã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚<li>ä½œæ¥­æ™‚é–“ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li><li>å½Œå°ï¼šè«‹å‘ŠçŸ¥æ˜¯å¦éœ€è¦å½Œå°æˆ–åˆ†é–‹å½Œå°ã€‚</li></ul>`
            },
            english_in_school: {
                title: "è‹±æ–‡åœ¨å­¸è­‰æ˜æ›¸ç”³è«‹",
                restriction: "é™åœ¨å­¸ç”Ÿç”³è«‹ï¼Œé ˆé™„è­·ç…§å½±æœ¬ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>`
            },
            english_suspension_cert: {
                title: "è‹±æ–‡ä¼‘å­¸è­‰æ˜æ›¸ç”³è«‹",
                restriction: "ç„¡ç‰¹æ®Šéƒµå¯„é™åˆ¶ã€‚é ˆé™„è­·ç…§å½±æœ¬ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>`
            },
            english_completion_cert: {
                title: "è‹±æ–‡ä¿®æ¥­è­‰æ˜æ›¸ç”³è«‹",
                restriction: "åƒ…é€€å­¸ç”Ÿå¯ç”³è«‹ã€‚é ˆé™„è­·ç…§å½±æœ¬ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>`
            },
            english_degree_cert: {
                title: "è‹±æ–‡å­¸ä½è­‰æ˜æ›¸ç”³è«‹",
                restriction: "é ˆé™„è­·ç…§å½±æœ¬ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$100/ä»½ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 3 å€‹å·¥ä½œå¤©ã€‚</li></ul>`
            },
            english_old_grad: {
                title: "è‹±æ–‡ç•¢æ¥­è­‰æ˜æ›¸ç”³è«‹ (92å¹´å‰ç•¢æ¥­)",
                restriction: "92å¹´å‰ç•¢æ¥­è€…é©ç”¨ï¼Œé ˆé™„è­·ç…§å½±æœ¬ã€‚",
                content: `<ul class="step-list"><li>å·¥æœ¬è²»ï¼š$10/ä»½ã€‚</li><li>æ™‚ç¨‹ï¼šç´„ 7 å€‹å·¥ä½œå¤©ã€‚</li></ul>`
            }
        };

        function showDocumentDetail(key) {
            const data = documentData[key];
            if (!data) return;
            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('modalBody').innerHTML = data.content;
            document.getElementById('mailRestriction').textContent = data.restriction; 
            document.getElementById('documentModal').style.display = 'block';
        }

        function closeModal() { document.getElementById('documentModal').style.display = 'none'; }
        window.onclick = function(event) { if (event.target == document.getElementById('documentModal')) closeModal(); }

        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('.calc-input, #envelope-type, #seal-count, #mail-method');
            inputs.forEach(el => el.addEventListener('input', calculatePreciseFees));
            calculatePreciseFees();
        });

        function calculatePreciseFees() {
            let price = 0, weight = 0;
            document.querySelectorAll('.calc-input').forEach(i => {
                const count = Number(i.value) || 0;
                price += count * Number(i.getAttribute('data-price'));
                weight += count * Number(i.getAttribute('data-weight'));
            });
            weight += Number(document.getElementById('envelope-type').value) || 0;
            weight += (Number(document.getElementById('seal-count').value) || 0) * 10;

            let baseFee = 0;
            if (weight > 0) {
                if (weight <= 20) baseFee = 28;
                else if (weight <= 50) baseFee = 36;
                else if (weight <= 100) baseFee = 44;
                else if (weight <= 250) baseFee = 60;
                else if (weight <= 500) baseFee = 92;
                else if (weight <= 1000) baseFee = 132;
                else baseFee = 180;
            }
            const mailMethod = document.getElementById('mail-method').value;
            const finalStamp = (baseFee > 0) ? baseFee + (mailMethod === 'express-reg' ? 7 : 0) : 0;

            document.getElementById('money-order-total').textContent = isNaN(price) ? 0 : price;
            document.getElementById('stamp-total').textContent = isNaN(finalStamp) ? 0 : finalStamp;
            document.getElementById('total-weight').textContent = isNaN(weight) ? 0 : weight;
        }
    </script>
</body>
</html>
